--=== UI ===--
local ScreenGui = Instance.new("ScreenGui", game.Players.LocalPlayer:WaitForChild("PlayerGui"))
local OpenBtn = Instance.new("TextButton", ScreenGui)
local Frame = Instance.new("Frame", ScreenGui)
local FlyBtn = Instance.new("TextButton", Frame)

ScreenGui.ResetOnSpawn = false

OpenBtn.Size = UDim2.new(0,120,0,40)
OpenBtn.Position = UDim2.new(0,20,0,200)
OpenBtn.BackgroundColor3 = Color3.fromRGB(40,40,40)
OpenBtn.Text = "MENU"

Frame.Visible = false
Frame.Size = UDim2.new(0,180,0,120)
Frame.Position = UDim2.new(0,20,0,250)
Frame.BackgroundColor3 = Color3.fromRGB(20,20,20)

FlyBtn.Size = UDim2.new(1,-20,0,40)
FlyBtn.Position = UDim2.new(0,10,0,10)
FlyBtn.BackgroundColor3 = Color3.fromRGB(60,60,60)
FlyBtn.Text = "Fly: OFF"

--=== ЛОГИКА ===--
local player = game.Players.LocalPlayer
local char = player.Character or player.CharacterAdded:Wait()
local hum = char:WaitForChild("Humanoid")
local flying = false
local bv, bg

OpenBtn.MouseButton1Click:Connect(function()
	Frame.Visible = not Frame.Visible
end)

local function startFly()
	flying = true
	FlyBtn.Text = "Fly: ON"

	bv = Instance.new("BodyVelocity", char.HumanoidRootPart)
	bv.MaxForce = Vector3.new(9e9,9e9,9e9)

	bg = Instance.new("BodyGyro", char.HumanoidRootPart)
	bg.MaxTorque = Vector3.new(9e9,9e9,9e9)

	hum.PlatformStand = true
end

local function stopFly()
	flying = false
	FlyBtn.Text = "Fly: OFF"

	hum.PlatformStand = false
	if bv then bv:Destroy() end
	if bg then bg:Destroy() end
end

FlyBtn.MouseButton1Click:Connect(function()
	if flying then stopFly() else startFly() end
end)

-- управление WASD
local UIS = game:GetService("UserInputService")
local run = game:GetService("RunService")

run.RenderStepped:Connect(function()
	if flying and bv then
		local cam = workspace.CurrentCamera.CFrame
		local dir = Vector3.zero

		if UIS:IsKeyDown(Enum.KeyCode.W) then dir += cam.LookVector end
		if UIS:IsKeyDown(Enum.KeyCode.S) then dir -= cam.LookVector end
		if UIS:IsKeyDown(Enum.KeyCode.A) then dir -= cam.RightVector end
		if UIS:IsKeyDown(Enum.KeyCode.D) then dir += cam.RightVector end
		if UIS:IsKeyDown(Enum.KeyCode.Space) then dir += Vector3.new(0,1,0) end
		if UIS:IsKeyDown(Enum.KeyCode.LeftControl) then dir -= Vector3.new(0,1,0) end

		bv.Velocity = dir * 60
		bg.CFrame = cam
	end
end)
